<?php
  /*
   * This model represents the necessary functionality to authenticate users,
   * and to regulate their access rights.
   */
class Experiments extends AppModel{

  var $name	= 'Experiments';
  var $useTable = 'experiments';
  var $primaryKey = "experiment_id";



  function getDefaultInformation($exp_id){
    $exp_id	= mysql_real_escape_string($exp_id);
    $query	= "SELECT a.*,COUNT(b.`transcript_id`) as transcript_count,d.`name`,d.`URL`,d.`plaza_linkout` FROM `experiments` a LEFT JOIN `transcripts` b ON a.`experiment_id`=b.`experiment_id` JOIN `data_sources` d ON a.`used_plaza_database`=d.`db_name` WHERE a.`experiment_id`='".$exp_id."' "; 
    $res = $this->query($query);
    $result = array();
    if($res){
    	$result	= $res[0]['a'];
    	$result["transcript_count"] = $res[0][0]['transcript_count'];
	$result["datasource"] = $res[0]['d']['name'];
	$result["datasource_URL"] = $res[0]['d']['URL'];
	$result["allow_linkout"]  = $res[0]['d']['plaza_linkout'];	
    }
    return $result;
  }


}


?>