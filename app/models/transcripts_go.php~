<?php
  /*
   * This model represents info on the transcripts
   */
class TranscriptsGo extends AppModel{

  var $name	= 'TranscriptsGo';
  var $useTable = 'transcripts_go';

  

  function findTranscriptsFromGo($exp_id,$go_terms){
    $result	= array();
    $go_terms_string	= "('".implode("','",array_keys($go_terms))."')";
    $query	= "SELECT `go`,count(`transcript_id`) as count FROM `transcripts_go` WHERE `experiment_id`='".$exp_id."' AND `go` IN ".$go_terms_string." GROUP BY `go` ";
    $res	= $this->query($query);
    foreach($res as $r){
      $result[$r['transcripts_go']['go']] = array("count"=>$r[0]['count'],"desc"=>$go_terms[$r['transcripts_go']['go']]);
    }
    return $result;
  }


  function getStats($exp_id){
    $query	= "SELECT COUNT(DISTINCT(`go`)) as count1, COUNT(DISTINCT(`transcript_id`)) as count2 FROM `transcripts_go` WHERE `experiment_id`='".$exp_id."' ";
    $res	= $this->query($query);
    $result	= array("num_go"=>0,"num_transcript_go"=>0);
    if($res){
      $result["num_go"]			= $res[0][0]['count1'];
      $result["num_transcript_go"]	= $res[0][0]['count2'];
    }
    return $result;
  }



}


?>